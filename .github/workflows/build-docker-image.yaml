name: Docker Image CI

on: [pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # - name: 💁‍♂️ Fetch package version from package.json
      #   id: image_tag
      #   run: |
      #     content="${content//'%'/'%25'}"
      #     content="${content//$'\n'/'%0A'}"
      #     content="${content//$'\r'/'%0D'}"
      #     echo "::set-output name=packageJson::$content"

      # - run: echo "Looks like this version will be ${{fromJson(steps.set_var.outputs.packageJson).version}} 🤔"

      - name: 🏃‍♂️ Setup workflow runner
        uses: actions/checkout@v2

      - name: 🏗 Build Docker image
        run: docker build . --file Dockerfile --tag norriswu/what-am-i-having-today:$(date)

      - name: 🚀 Push image to docker hub
        run: docker push norriswu/what-am-i-having-today:$(date)
